import{a as r,j as t}from"./app-8d52f51b.js";import{a as W}from"./api-ae86b069.js";import{r as l}from"./routes-c9e5dec8.js";import{s as w}from"./validate-45498d25.js";import{D as A,a as B,b as j}from"./DialogTitle-0a6c9e9a.js";import{B as E}from"./Box-eda8d922.js";import{G as s}from"./Grid-227526a7.js";import{T as m}from"./TextField-ced4731f.js";import{T as F}from"./Typography-117e9b47.js";import{L as G}from"./OutlinedInput-6fe70e23.js";import{L as b,a as x}from"./ListItem-02d28df5.js";import{L as z}from"./ListItemAvatar-6623829d.js";import{L as M}from"./ListItemText-6348469b.js";import{S as Y}from"./Stack-afb354de.js";import{I as _}from"./IconButton-06508ab2.js";import{D as H}from"./Delete-1e22dba7.js";import{b as v}from"./Button-8cbba6d3.js";import{L as J}from"./LoadingButton-a6d6e79d.js";import{S as K}from"./Save-c19d0d15.js";import"./Modal-54129959.js";import"./useControlled-c0dbec42.js";import"./ButtonBase-c5fb3adc.js";import"./listItemTextClasses-5dc35ea7.js";import"./CircularProgress-64102110.js";const ft=({open:y,onClose:L,defaultValue:a={id:void 0,order:void 0,title:"",body:"",questions:[]}})=>{var C;const{data:e,setData:d,submit:S,processing:c,handleChange:p,errors:h,setError:T,reset:k,clearErrors:q}=W({...a,_method:a.id?"put":"post"},a.id?l.consents.update.link(a.id):l.consents.add.link),u=()=>{L(),k()},f=i=>{i.preventDefault(),q(),w(e,T)&&S({onSuccess:u})},D=i=>()=>{let o=[...e.questions??[]];o.splice(i,1),d(n=>({...n,questions:o}))},g=i=>o=>{let n=[...e.questions??[]];n.splice(i,1,{...e==null?void 0:e.questions[i],[o.target.name]:o.target.value}),d(Q=>({...Q,questions:n}))},I=i=>{i.preventDefault();let o=[...e.questions??[]];o.push({summaryTitle:"",context:""}),d(n=>({...n,questions:o}))};return r(A,{open:y,onClose:u,keepMounted:!0,fullWidth:!0,maxWidth:"md",children:[t(B,{children:e.id?"Edit Consent":"Add Consent"}),t(j,{children:t(E,{component:"form",method:"post",sx:{pt:2},action:e.id?l.consents.update.link(e.id):l.consents.add.link,onSubmit:f,children:r(s,{container:!0,spacing:2,children:[t(s,{item:!0,xs:12,children:t(m,{name:"title",label:"Consent Title",value:e.title,required:!0,onChange:p,error:!!h.title,fullWidth:!0})}),t(s,{item:!0,xs:12,children:t(m,{name:"body",label:"Body",value:e.body,required:!0,multiline:!0,rows:5,onChange:p,error:!!h.body,fullWidth:!0})}),r(s,{item:!0,xs:12,children:[t(F,{fontWeight:"600",children:"Questions"}),r(G,{children:[(C=e==null?void 0:e.questions)==null?void 0:C.map((i,o)=>r(b,{children:[t(z,{children:o+1}),t(M,{children:r(Y,{spacing:2,direction:"row",children:[t(m,{fullWidth:!0,sx:{maxWidth:"300px"},value:i.summaryTitle,name:"summaryTitle",onChange:g(o),label:"Summary Title"}),t(m,{fullWidth:!0,multiline:!0,rows:2,value:i.context,name:"context",onChange:g(o),label:"context"})]})}),t(x,{children:t(_,{color:"error",onClick:D(o),children:t(H,{})})})]},o)),t(b,{sx:{paddingY:"2em"},children:t(x,{children:t(v,{variant:"contained",onClick:I,children:"Add Question"})})})]})]}),r(s,{item:!0,xs:12,children:[t(v,{onClick:u,disabled:c,variant:"text",size:"large",children:"Cancel"}),t(J,{loading:c,size:"medium",variant:"contained",onClick:f,startIcon:t(K,{}),children:"Submit"})]})]})})})]})};export{ft as default};
