import{a as r,j as t}from"./app-468dc84b.js";import{a as W}from"./api-a48cce3e.js";import{r as l}from"./routes-c9e5dec8.js";import{s as w}from"./validate-1e59ab84.js";import{D as A,a as B,b as j}from"./DialogTitle-a60b1fca.js";import{B as E}from"./Box-d6830782.js";import{G as s}from"./Grid-0f88e4d2.js";import{T as m}from"./TextField-f525cea2.js";import{T as F}from"./Typography-fb8ff41b.js";import{L as G}from"./OutlinedInput-f8af1941.js";import{L as b,a as x}from"./ListItem-39e1e94f.js";import{L as z}from"./ListItemAvatar-816c56e6.js";import{L as M}from"./ListItemText-6355ef3f.js";import{S as Y}from"./Stack-6d196264.js";import{I as _}from"./IconButton-9a3de394.js";import{D as H}from"./Delete-60a51ebb.js";import{b as v}from"./Button-132598f8.js";import{L as J}from"./LoadingButton-32a80b82.js";import{S as K}from"./Save-8cb0cf59.js";import"./Modal-784d8689.js";import"./useControlled-b95c8f2a.js";import"./ButtonBase-d47d007c.js";import"./listItemTextClasses-d306ad49.js";import"./CircularProgress-a38e80be.js";const ft=({open:y,onClose:L,defaultValue:a={id:void 0,order:void 0,title:"",body:"",questions:[]}})=>{var C;const{data:e,setData:d,submit:S,processing:c,handleChange:p,errors:h,setError:T,reset:k,clearErrors:q}=W({...a,_method:a.id?"put":"post"},a.id?l.consents.update.link(a.id):l.consents.add.link),u=()=>{L(),k()},f=i=>{i.preventDefault(),q(),w(e,T)&&S({onSuccess:u})},D=i=>()=>{let o=[...e.questions??[]];o.splice(i,1),d(n=>({...n,questions:o}))},g=i=>o=>{let n=[...e.questions??[]];n.splice(i,1,{...e==null?void 0:e.questions[i],[o.target.name]:o.target.value}),d(Q=>({...Q,questions:n}))},I=i=>{i.preventDefault();let o=[...e.questions??[]];o.push({summaryTitle:"",context:""}),d(n=>({...n,questions:o}))};return r(A,{open:y,onClose:u,keepMounted:!0,fullWidth:!0,maxWidth:"md",children:[t(B,{children:e.id?"Edit Consent":"Add Consent"}),t(j,{children:t(E,{component:"form",method:"post",sx:{pt:2},action:e.id?l.consents.update.link(e.id):l.consents.add.link,onSubmit:f,children:r(s,{container:!0,spacing:2,children:[t(s,{item:!0,xs:12,children:t(m,{name:"title",label:"Consent Title",value:e.title,required:!0,onChange:p,error:!!h.title,fullWidth:!0})}),t(s,{item:!0,xs:12,children:t(m,{name:"body",label:"Body",value:e.body,required:!0,multiline:!0,rows:5,onChange:p,error:!!h.body,fullWidth:!0})}),r(s,{item:!0,xs:12,children:[t(F,{fontWeight:"600",children:"Questions"}),r(G,{children:[(C=e==null?void 0:e.questions)==null?void 0:C.map((i,o)=>r(b,{children:[t(z,{children:o+1}),t(M,{children:r(Y,{spacing:2,direction:"row",children:[t(m,{fullWidth:!0,sx:{maxWidth:"300px"},value:i.summaryTitle,name:"summaryTitle",onChange:g(o),label:"Summary Title"}),t(m,{fullWidth:!0,multiline:!0,rows:2,value:i.context,name:"context",onChange:g(o),label:"context"})]})}),t(x,{children:t(_,{color:"error",onClick:D(o),children:t(H,{})})})]},o)),t(b,{sx:{paddingY:"2em"},children:t(x,{children:t(v,{variant:"contained",onClick:I,children:"Add Question"})})})]})]}),r(s,{item:!0,xs:12,children:[t(v,{onClick:u,disabled:c,variant:"text",size:"large",children:"Cancel"}),t(J,{loading:c,size:"medium",variant:"contained",onClick:f,startIcon:t(K,{}),children:"Submit"})]})]})})})]})};export{ft as default};
