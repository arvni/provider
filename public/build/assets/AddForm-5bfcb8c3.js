import{a as r,j as t}from"./app-598c3492.js";import{a as W}from"./api-946b6138.js";import{r as l}from"./routes-c9e5dec8.js";import{s as w}from"./validate-d7712270.js";import{D as A,a as B,b as j}from"./DialogTitle-13db25e5.js";import{B as E}from"./Box-4ecef40b.js";import{G as s}from"./Grid-cde2aa95.js";import{T as m}from"./TextField-9f3426c0.js";import{T as F}from"./Typography-90153eaf.js";import{L as G}from"./OutlinedInput-a4456b4a.js";import{L as b,a as x}from"./ListItem-232e4751.js";import{L as z}from"./ListItemAvatar-0d61c5e9.js";import{L as M}from"./ListItemText-72819d32.js";import{S as Y}from"./Stack-50558ccb.js";import{I as _}from"./IconButton-f3375e8f.js";import{D as H}from"./Delete-3ce28d9c.js";import{b as v}from"./Button-3c3de6cc.js";import{L as J}from"./LoadingButton-f817cea9.js";import{S as K}from"./Save-c7c89ae8.js";import"./Modal-537603b2.js";import"./useControlled-d4beb3be.js";import"./ButtonBase-f9aad11e.js";import"./listItemTextClasses-7720011d.js";import"./CircularProgress-2d5c2476.js";const ft=({open:y,onClose:L,defaultValue:a={id:void 0,order:void 0,title:"",body:"",questions:[]}})=>{var C;const{data:e,setData:d,submit:S,processing:c,handleChange:p,errors:h,setError:T,reset:k,clearErrors:q}=W({...a,_method:a.id?"put":"post"},a.id?l.consents.update.link(a.id):l.consents.add.link),u=()=>{L(),k()},f=i=>{i.preventDefault(),q(),w(e,T)&&S({onSuccess:u})},D=i=>()=>{let o=[...e.questions??[]];o.splice(i,1),d(n=>({...n,questions:o}))},g=i=>o=>{let n=[...e.questions??[]];n.splice(i,1,{...e==null?void 0:e.questions[i],[o.target.name]:o.target.value}),d(Q=>({...Q,questions:n}))},I=i=>{i.preventDefault();let o=[...e.questions??[]];o.push({summaryTitle:"",context:""}),d(n=>({...n,questions:o}))};return r(A,{open:y,onClose:u,keepMounted:!0,fullWidth:!0,maxWidth:"md",children:[t(B,{children:e.id?"Edit Consent":"Add Consent"}),t(j,{children:t(E,{component:"form",method:"post",sx:{pt:2},action:e.id?l.consents.update.link(e.id):l.consents.add.link,onSubmit:f,children:r(s,{container:!0,spacing:2,children:[t(s,{item:!0,xs:12,children:t(m,{name:"title",label:"Consent Title",value:e.title,required:!0,onChange:p,error:!!h.title,fullWidth:!0})}),t(s,{item:!0,xs:12,children:t(m,{name:"body",label:"Body",value:e.body,required:!0,multiline:!0,rows:5,onChange:p,error:!!h.body,fullWidth:!0})}),r(s,{item:!0,xs:12,children:[t(F,{fontWeight:"600",children:"Questions"}),r(G,{children:[(C=e==null?void 0:e.questions)==null?void 0:C.map((i,o)=>r(b,{children:[t(z,{children:o+1}),t(M,{children:r(Y,{spacing:2,direction:"row",children:[t(m,{fullWidth:!0,sx:{maxWidth:"300px"},value:i.summaryTitle,name:"summaryTitle",onChange:g(o),label:"Summary Title"}),t(m,{fullWidth:!0,multiline:!0,rows:2,value:i.context,name:"context",onChange:g(o),label:"context"})]})}),t(x,{children:t(_,{color:"error",onClick:D(o),children:t(H,{})})})]},o)),t(b,{sx:{paddingY:"2em"},children:t(x,{children:t(v,{variant:"contained",onClick:I,children:"Add Question"})})})]})]}),r(s,{item:!0,xs:12,children:[t(v,{onClick:u,disabled:c,variant:"text",size:"large",children:"Cancel"}),t(J,{loading:c,size:"medium",variant:"contained",onClick:f,startIcon:t(K,{}),children:"Submit"})]})]})})})]})};export{ft as default};
